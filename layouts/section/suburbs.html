<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Site.Title }} | All Suburbs by State</title> <!-- Use Site title & specific page title -->
    <link rel="stylesheet" href="{{ "css/style.css" | relURL }}">
</head>
<body>
    <header>
        <!-- Keep existing header or integrate theme header if desired -->
        <h1>Australian Suburbs by State</h1>
        <p>Explore all suburbs sorted alphabetically within each state.</p>
    </header>

    <main> <!-- Keep the main container -->
        {{ $allSuburbPages := where .Site.Pages "Type" "suburbs" }}
        {{ $suburbsToGroup := where $allSuburbPages "Kind" "page" }}

        {{ if $suburbsToGroup }}
            <!-- Get all unique state values -->
            {{ $states := slice }}
            {{ range $suburbsToGroup }}
                {{ $state := .Params.state | default "unknown" }}
                {{ $states = $states | append $state }}
            {{ end }}
            {{ $states = uniq $states | sort }}

            <!-- Removed debug text -->

            {{ range $states }}
                {{ $state := . }}
                {{ $pagesInState := where $suburbsToGroup "Params.state" $state }}
                {{ $sortedPages := sort $pagesInState "Title" }}

                <section class="state-section"> <!-- Added a section wrapper for better structure/spacing -->
                    <h3>{{ $state }} ({{ len $pagesInState }} suburbs)</h3>
                    <ul class="suburb-list"> <!-- Added class="suburb-list" -->
                        {{ range $sortedPages }}
                            <li> <!-- Keep list item simple -->
                                <a href="{{ .Permalink }}">{{ .Title }}</a>
                                {{/* Removed postcode display for cleaner columns, add back if desired
                                {{ if .Params.postcode }} - {{ .Params.postcode }}{{ end }}
                                */}}
                            </li>
                        {{ end }}
                    </ul>
                </section>
            {{ end }}
        {{ else }}
            <p>No suburb pages found.</p>
        {{ end }}
    </main>

    <footer>
         <!-- Keep existing footer -->
        <p>Â© {{ now.Format "2006" }} Aussie Suburbs</p>
    </footer>
</body>
</html>